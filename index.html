<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç–∞—Ç—É—Å –±–∞—Ç–∞—Ä–µ–∏</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
        .battery-info { font-size: 20px; margin: 10px; }
    </style>
</head>
<body>

    <h1>–°—Ç–∞—Ç—É—Å –±–∞—Ç–∞—Ä–µ–∏</h1>
    <div class="battery-info" id="chargeLevel"></div>
    <div class="battery-info" id="chargingStatus"></div>

    <script>
        async function updateBatteryInfo() {
            if (!navigator.getBattery) {
                document.body.innerHTML = "<h2>–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç API –±–∞—Ç–∞—Ä–µ–∏</h2>";
                return;
            }

            const battery = await navigator.getBattery();
            let lastChargeLevel = battery.level;
            let lastTimestamp = Date.now();
            let chargeSpeedInterval;

            function refreshBatteryInfo() {
                document.getElementById("chargeLevel").innerText = `üîã –£—Ä–æ–≤–µ–Ω—å –∑–∞—Ä—è–¥–∞: ${(battery.level * 100).toFixed(1)}%`;
                document.getElementById("chargingStatus").innerText = battery.charging ? "‚ö° –°—Ç–∞—Ç—É—Å: –ó–∞—Ä—è–∂–∞–µ—Ç—Å—è" : "üîå –°—Ç–∞—Ç—É—Å: –ù–µ –∑–∞—Ä—è–∂–∞–µ—Ç—Å—è";

                if (!battery.charging) {
                    document.getElementById("chargingSpeed").innerText = `‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞—Ä—è–¥–∫–∏: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ`;
                    clearInterval(chargeSpeedInterval);
                }
            }

            function calculateChargingSpeed() {
                if (!battery.charging) return;

                let currentChargeLevel = battery.level;
                let currentTimestamp = Date.now();
                let chargeDifference = (currentChargeLevel - lastChargeLevel) * 100;
                let timeDifference = (currentTimestamp - lastTimestamp) / 1000;

                if (timeDifference > 0 && chargeDifference !== 0) {
                    let chargeSpeed = (chargeDifference / timeDifference) * 60; // –í –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –≤ –º–∏–Ω—É—Ç—É
                    document.getElementById("chargingSpeed").innerText = `‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞—Ä—è–¥–∫–∏: ${chargeSpeed.toFixed(2)}%/–º–∏–Ω`;
                }

                lastChargeLevel = currentChargeLevel;
                lastTimestamp = currentTimestamp;
            }

            battery.addEventListener("chargingchange", () => {
                refreshBatteryInfo();
                if (battery.charging) {
                    document.getElementById("chargingSpeed").innerText = `‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –∑–∞—Ä—è–¥–∫–∏: 0.00%/–º–∏–Ω`;
                    lastChargeLevel = battery.level;
                    lastTimestamp = Date.now();
                    clearInterval(chargeSpeedInterval);
                    chargeSpeedInterval = setInterval(calculateChargingSpeed, 2000);
                }
            });

            battery.addEventListener("levelchange", refreshBatteryInfo);
            refreshBatteryInfo();
        }

        updateBatteryInfo();
    </script>

</body>
</html>
